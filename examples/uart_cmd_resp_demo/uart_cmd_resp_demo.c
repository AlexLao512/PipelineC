// TODO not fsm style regular HDL version